<!doctype html>
<html lang="" style="width: 100%; height: 100%; margin: 0">
	<head>
		<title>Base Page</title>

		<meta name="viewport" content= "width=device-width, user-scalable=no">

		<script src="https://d3js.org/d3.v7.min.js"></script>
		<script src="javascript/Vec.js" ></script>
		<script src="javascript/Animations.js" ></script>
		<script src="javascript/Dealer.js" ></script>
		<script src="javascript/Card.js"></script>
		<script src="javascript/GridManager.js" ></script>
		<script src="javascript/CardFaceManager.js"></script>
		<script src="javascript/PopupManager.js"></script>
		<script src="javascript/OverscrollDetector.js"></script>


		<link rel="stylesheet" href="css/card.css"/>
		<link rel="stylesheet" href="css/popup.css"/>
	</head>

	<body style="width: 100%; height: 100%; margin: 0; overflow-x: hidden;">

		<div id="canvas">

			<img class="title" src="assets/title3.png"/>
			<img class="title" src="assets/title5.png"/>
			<img class="title" src="assets/title10.png"/>


		<!--
 ________________________________________
/ And thus spoke the villain "Thou shalt \
| populate thine card faces within the   |
| index file!" and all fell silent with  |
\ sorrow...                              /
 ----------------------------------------
        \   ^__^
         \  (--)\_______
            (__)\       )\/\
                ||----w |
                ||     ||
		-->

	<div class="card first" id="card-outer first">
			<div class="card-inner first" id="card-inner first">
					<div class="card-back first" id="card-back first">
							<img class="card-img first" id="card-img first" src="assets/back.smallest.png">
					</div>
					<div class="card-face first" id="card-face first">
						<!--Template Me-->
						<div class="card-img first" style='background-image: url("assets/1.smallest.png") ; background-size: 100%; position: inherit;'>
							<p style='cursor: pointer; height: 100%; width:100%; font-size: 5.5vh; color: white'>Test Text</p>
						</div>

					</div>
			</div>
	</div>


	<div class="card second" id="card-outer second">
			<div class="card-inner second" id="card-inner second">
					<div class="card-back second" id="card-back second">
							<img class="card-img second" id="card-img second" src="assets/back.smallest.png">
					</div>
					<div class="card-face second" id="card-face second">

						<img class="card-img second" src="assets/2.smallest.png" style ='height: 100%; width: 100%'>

						<!--Template Me-->

					</div>
			</div>
	</div>


	<div class="card third" id="card-outer third">
			<div class="card-inner third" id="card-inner third">
					<div class="card-back third" id="card-back third">
							<img class="card-img third" id="card-img third" src="assets/back.smallest.png">
					</div>
					<div class="card-face third" id="card-face third">

						<img class="card-img third" src="assets/3.smallest.png" style='height: 100%; width: 100%'>

						<!--Template Me-->

					</div>
			</div>
	</div>


	<div class="card fourth" id="card-outer fourth">
			<div class="card-inner fourth" id="card-inner fourth">
					<div class="card-back fourth" id="card-back fourth">
							<img class="card-img fourth" id="card-img fourth" src="assets/back.smallest.png">
					</div>
					<div class="card-face fourth" id="card-face fourth">

						<img class="card-img fourth" src="assets/4.smallest.png" style='height: 100%; width: 100%'>

						<!--Template Me-->

					</div>
			</div>
	</div>


	<div class="card fifth" id="card-outer fifth">
			<div class="card-inner fifth" id="card-inner fifth">
					<div class="card-back fifth" id="card-back fifth">
							<img class="card-img fifth" id="card-img fifth" src="assets/back.smallest.png">
					</div>
					<div class="card-face fifth" id="card-face fifth">

						<img class="card-img fifth" src="assets/5.smallest.png" style='height: 100%; width: 100%'>

						<!--Template Me-->

					</div>
			</div>
	</div>


	<div class="card sixth" id="card-outer sixth">
			<div class="card-inner sixth" id="card-inner sixth">
					<div class="card-back sixth" id="card-back sixth">
							<img class="card-img sixth" id="card-img sixth" src="assets/back.smallest.png">
					</div>
					<div class="card-face sixth" id="card-face sixth">

						<img class="card-img sixth" src="assets/6.smallest.png" style='height: 100%; width: 100%'>

						<!--Template Me-->

					</div>
			</div>
	</div>


	<div class="card seventh" id="card-outer seventh">
			<div class="card-inner seventh" id="card-inner seventh">
					<div class="card-back seventh" id="card-back seventh">
							<img class="card-img seventh" id="card-img seventh" src="assets/back.smallest.png">
					</div>
					<div class="card-face seventh" id="card-face seventh">

						<img class="card-img seventh" src="assets/7.smallest.png" style='height: 100%; width: 100%'>

						<!--Template Me-->

					</div>
			</div>
	</div>


	<div class="card eigthth" id="card-outer eigthth">
			<div class="card-inner eighth" id="card-inner eigthth">
					<div class="card-back eighth" id="card-back eigthth">
							<img class="card-img eighth" id="card-img eighth" src="assets/back.smallest.png">
					</div>
					<div class="card-face eighth" id="card-face eighth">

						<img class="card-img eighth" src="assets/8.smallest.png">

						<!--Template Me-->

					</div>
			</div>
	</div>

		</div>

		<div id="popup-canvas" class="popup-canvas">
			<div id="popup" class="popup">

			</div>
		</div>

		<template id="duck">
			<img src="assets/duck.png" style="position: relative; width: 50vh; max-width: 100%;"/>
			<img src="assets/duck.png" style="position: relative; width: 50vh; max-width: 100%;"/>
			<img src="assets/duck.png" style="position: relative; width: 50vh; max-width: 100%;"/>
			<img src="assets/duck.png" style="position: relative; width: 50vh; max-width: 100%;"/>
		</template>





		<script>


			let gm, cfm, pm;

			const onload1 = () =>
			{
				let pparams1 = [ new AnimParams ( null, new Vec ( 50 ), null ),  new AnimParams ( null, new Vec ( 50 ), null ) ];
				let pparams2 = [ new AnimParams ( null, new Vec ( 80 ), 90 ),  new AnimParams ( null, new Vec ( 20 ), 90 ) ];

				let params1 = new AnimParams ( null, null, 180 );
				let params2 = new AnimParams ( new Vec ( 500, 400 ), null, 359 );
				let params3 = new AnimParams ( new Vec ( 100, 200 ), null, 420 );

				let sanim = CardAnim.Setup ( d3.selectAll ( ".duck" ), "ease-in", 1000 )
					.continueTo ( pparams1 )
					.continueTo ( pparams2 )
					.addCallback ( () => console.log ( "callback 1" ) )
					.addCallback ( () => console.log ( "callback 2" ) )
					.singleContinueTo ( 0, params1 )
					.continueTo ( params2 )
					.continueTo ( params3 );

				sanim.animate();
			};

			const onload2 = () =>
			{
				const dealSize = new Vec ( 400, 150 );
				const dealPos = new Vec ( 200, 100 );
				const cardSize = new Vec ( 87, 122 ).mult ( 1.5 );

				/*
				d3.select ( "#svg" ).append ( "rect" )
					.attr ( "x", dealPos.x )
					.attr ( "y", dealPos.y )
					.attr ( "width", dealSize.x )
					.attr ( "height", dealSize.y );
				 */
				/*
				const cards = [];
				for ( let i = 0; i < 8; ++i )
					cards.push ( new Card (
						d3.select ( "#canvas" ),
						"assets/back.smallest.png",
						cardSize
					) );
				*/
				gm = new GridManager (
					d3.select ( "#canvas" ),
					d3.selectAll ( ".card" ),
					d3.selectAll ( ".title" ),
					cardSize,
					cardSize.mult ( new Vec ( 0.65, 0.2 ) ),
					[ new Vec ( 3, 1 ), new Vec ( 5, 1 ), new Vec ( 10, 1 ) ],
					[ 1, 2, 4 ],
					() => {

						cfm = new CardFaceManager ( d3.selectAll ( ".card" ) );
						cfm.flip ( 3 );
					} );

				document.getElementById("card-face first").onclick = () =>
				{
					gm.hideCards ();
					setTimeout ( () => gm.showCards (), 2000 );
				};

				pm = new PopupManager ( d3.select ( "#popup-canvas" ), d3.select ( "#popup" ), gm );


				document.getElementById("card-face second").onclick = () =>
				{
					pm.openPopup ( document.getElementById ( "duck" ).content.cloneNode ( true ) );
					//setTimeout ( () => pm.closePopup (), 2000 );
				};

			}

			window.onload = onload2;

		</script>

	</body>
</html>